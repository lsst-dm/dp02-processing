clusterAlgorithm: lsst.ctrl.bps.quantum_clustering_funcs.single_quantum_clustering
wmsServiceClass: desc.gen3_workflow.ParslService
parslConfig: desc.gen3_workflow.config.slurm_config

# Run in Singularity containers
commandPrepend: $DP02_ENV/dp02-tools/wrapper_singularity.sh

# CTRL_MPEXEC_DIR variable removed because of Singularity wrapper
runQuantumCommand: "pipetask {runPreCmdOpts} run -b {butlerConfig} -i {inCollection} -o {output} --output-run {outputRun} --qgraph {qgraphFile} --qgraph-id {qgraphId} --qgraph-node-id {qgraphNodeId} --clobber-outputs --skip-init-writes --extend-run {extraRunQuantumOptions}"

pipelineYaml: "${OBS_LSST_DIR}/pipelines/imsim/DRP.yaml#step1"

project: dp02
campaign: PREOPS-1092/step1_GNUM
submitPath: "${DP02_DIR}/submit/{outputRun}"
computeSite: ccin2p3
requestMemory: 3072
requestCpus: 1

includeConfigs:
  - requestMemory.yaml

payload:
  payloadName: 2.2i/runs/FRDF/DP0.2
  output: "{payloadName}/{campaign}"
  butlerConfig: /sps/lsst/users/lsstprod/dp0.2-dev/butler.yaml
  inCollection: "2.2i/defaults"
  dataQuery: "instrument='LSSTCam-imSim' and skymap='DC2' and exposure >=LOWEXP and exposure <= HIGHEXP"

# Needed for Parsl plugin
executionButler:
  whenCreate: "PREPARE"
